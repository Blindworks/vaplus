<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:p="http://primefaces.org/ui">

<h:body>


	<ui:composition template="/WEB-INF/template/common/commonLayout.xhtml">
		<ui:param name="heading1" value="Lohnabrechnung für #{payrollBean.selectedUserPayroll.user.name} im #{helperBean.getMonthName(payrollBean.selectedUserPayroll.month)} #{payrollBean.selectedUserPayroll.year}" />
		<ui:param name="bodyClass" value="right-sidebar-closed" />
		
		
		<ui:define name="content">	
			<h:form class="form-horizontal">
			
			<div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Übersicht</h5>
                    <div class="ibox-tools">
                    </div>
                </div>
                <div class="ibox-content">
			
					<div class="row">
						<div class="col-sm-6">
							<div class="row">
								<label class="col-lg-4 text-right">Name</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.name}</p>
								</div>
							</div>
							<div class="row">
		
								<label class="col-lg-4 text-right">Anschrift</label>
								<div class="col-lg-8">
									<p >
										#{payrollBean.selectedUserPayroll.user.address.street} #{payrollBean.selectedUserPayroll.user.address.streetNumber}<br/>
										<ui:fragment rendered="#{payrollBean.selectedUserPayroll.user.address.addressline.length() gt 0}">
										#{payrollBean.selectedUserPayroll.user.address.addressline}<br/>
										</ui:fragment>
										#{payrollBean.selectedUserPayroll.user.address.country}-#{payrollBean.selectedUserPayroll.user.address.zip} #{payrollBean.selectedUserPayroll.user.address.city}
									</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Geb. Datum</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.user.bday}" >
											<f:convertDateTime pattern="dd.MM.yyyy" timeZone="CET" />
										</h:outputText>
									</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Pers. Nummer</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.stuffNumber}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Tel</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.tel}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Email</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.email}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Position</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.jobTitle}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Beschäftigt als </label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.formOfEmployment}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Homeoffice</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.homeOffice ? 'Ja' : 'Nein'}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">Private KFZ-Nutzung</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.privateCarUsage ? 'Ja' : 'Nein'}</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">KFZ Preis</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.user.carGrossCatalogPrice}" >
											<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
										</h:outputText> €
									</p>
								</div>
							</div>
							<div class="row">
		                    
								<label class="col-lg-4 text-right">km zur Arbeitstätte</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.user.distanceToWorkplace}</p>
								</div>
							</div>
		                    
						</div>
						
						<div class="col-sm-6">
						
							<div class="row">
								<label class="col-lg-4 text-right">Monat</label>
								<div class="col-lg-8">
									<p >#{helperBean.getMonthName(payrollBean.selectedUserPayroll.month)} </p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">Jahr</label>
								<div class="col-lg-8">
									<p >#{payrollBean.selectedUserPayroll.year}</p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">Fixgehalt</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.basicSalary}" >
											<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
										</h:outputText> €
									</p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">Bonus</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.commission}" >
											<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
										</h:outputText> €
										von
										<h:outputText value="#{userBean.selectedUser.bonusSalary}" >
											<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
										</h:outputText> €
									</p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">Punkte</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.points}" >
											<f:convertNumber maxFractionDigits="4" minFractionDigits="0" />
										</h:outputText> <i class="fa fa-star"></i>
										von
										<h:outputText value="#{payrollBean.selectedUserPayroll.pointGoal}" >
											<f:convertNumber maxFractionDigits="4" minFractionDigits="0" />
										</h:outputText> <i class="fa fa-star"></i>
									</p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">Punkte minimum</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.minimalBonusPointGoal}" >
											<f:convertNumber maxFractionDigits="4" minFractionDigits="0" />
										</h:outputText> <i class="fa fa-star"></i>
									</p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">Zielerreichung </label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.goalAttainment}" >
											<f:convertNumber maxFractionDigits="2" minFractionDigits="0" />
										</h:outputText> %
									</p>
								</div>
							</div>
							<div class="row">
								<label class="col-lg-4 text-right">erwirt. Provision</label>
								<div class="col-lg-8">
									<p >
										<h:outputText value="#{payrollBean.selectedUserPayroll.yieldedCommission}" >
											<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
										</h:outputText> €
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			
			<div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Leistungsziele</h5>
                    <div class="ibox-tools">
                    	
                    </div>
                </div>
                <div class="ibox-content">
                			<h:panelGroup rendered="#{payrollBean.achievementList.size() == 0}">
				                	<p>Keine Leistungsziele vorhanden.</p>
				            </h:panelGroup>
				    		
				    		<h:panelGroup rendered="#{payrollBean.achievementList.size() > 0}">

                            <div class="table-responsive">
				                <h:dataTable value="#{payrollBean.achievementList}" var="item" class="table table-striped" >
						
									<h:column>
										<h:panelGroup rendered="#{item.targetReached}"><i class="fa fa-check text-green"></i></h:panelGroup>
										<h:panelGroup rendered="#{not item.targetReached}"><i class="fa fa-times text-danger"></i></h:panelGroup>
									</h:column>
									<h:column>
										<f:facet name="header">Name</f:facet>
										<h:outputText value="#{item.name}" />
									</h:column>
									<h:column>
										<f:facet name="header">Payout</f:facet>
										<h:outputText value="#{item.getPayout(payrollBean.selectedUserPayroll.user)}" />
									</h:column>
								</h:dataTable>
                            
                            </div>
                        
                        	</h:panelGroup>
                
				</div>
			</div>
			
			<div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Notizen</h5>
                    <div class="ibox-tools">
					    <h:commandLink  class="btn btn-xs btn-primary " action="#{payrollBean.saveSelectedPayroll()}">
						   <i class="fa fa-save"></i>
						</h:commandLink>
                    </div>
                </div>
                <div class="ibox-content">
					<h:inputTextarea rows="10" class="seamless" value="#{payrollBean.selectedUserPayroll.note}" />
				</div>
			</div>
			
			<div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Produkt Summen</h5>
                    <div class="ibox-tools">
                    </div>
                </div>
                <div class="ibox-content">
					
					
					
				</div>
			</div>
			
			<div class="row">
			<h:form id="salesOverviewForm">
                <div class="col-lg-12">
                    
                </div>
                </h:form>
            </div>
            
            <div class="row">
            	<h:panelGroup id="commissionActivityList">
                <div class="col-lg-12">
                    <div class="ibox">
                        <div class="ibox-title">
                            <h5>Korrekturbuchungen</h5>
                            <div class="ibox-tools">
                            </div>
                        </div>
                        <div class="ibox-content">
                        
				    		<h:panelGroup rendered="#{payrollBean.commissionActivityList.size() == 0}">
				                	<p>Keine Buchungen vorhanden.</p>
				            </h:panelGroup>
				    		
				    		<h:panelGroup rendered="#{payrollBean.commissionActivityList.size() > 0}">

                            <div class="table-responsive">
				                <h:dataTable value="#{payrollBean.commissionActivityList}" var="item" class="table table-striped" >
						
									<h:column>
										<h:panelGroup rendered="#{item.enabled}"><i class="fa fa-check-square-o"></i></h:panelGroup>
										<h:panelGroup rendered="#{not item.enabled}"><i class="fa fa-square-o"></i></h:panelGroup>
									</h:column>
									<h:column>
										<f:facet name="header">Buchung</f:facet>
										<h:outputText value="#{item.id}" />
									</h:column>
									<h:column>
										<f:facet name="header">Ursprungs Buchung</f:facet>
										
										<ui:fragment rendered="#{item['class'].simpleName == 'BaseContractCancellationEntity'}">
											#{item.contract.id} 
											vom 
											<h:outputText value="#{item.contract.effectiveDate}" >
										  		<f:convertDateTime type="date" pattern="dd.MM.yy" timeZone="CET"/>
										  	</h:outputText>
										</ui:fragment>
										
									</h:column>
									<h:column>
										<f:facet name="header">Filiale</f:facet>
										<h:outputText value="#{item.shop.name}" />
									</h:column>
									<h:column>
										<f:facet name="header">Notiz</f:facet>
										<h:outputText value="#{item.note}" />
									</h:column>
									<h:column>
										<f:facet name="header">Datum</f:facet>
										<h:outputText value="#{item.effectiveDate}" >
									  		<f:convertDateTime type="date" pattern="dd.MM.yy HH:mm" timeZone="CET"/>
									  	</h:outputText>
									</h:column>
									<h:column>
										<f:facet name="header">Punkte</f:facet>
										<span class="text-red">
											<h:outputText value="#{item.commission.points}" >
												<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
											</h:outputText>
											<i class="fa fa-star"></i>
										</span>
									</h:column>
									
									
									
									
								</h:dataTable>
                            
                            </div>
                        
                        	</h:panelGroup>
                        	
                        </div>

                    </div>
                </div>
               </h:panelGroup>
        </div>
			
			
		<div class="row">
			<h:form id="salesContractForm">
                <div class="col-lg-12">
                    <div class="ibox">
                        <div class="ibox-title">
                            <h5>Verträge</h5>
                            <div class="ibox-tools">
                            </div>
                        </div>
                        <div class="ibox-content">
                        
				    		<h:panelGroup rendered="#{payrollBean.contractList.size() == 0}">
				                	<p>Keine Verträge zur Ansicht vorhanden.</p>
				            </h:panelGroup>
				    		
				    		<h:panelGroup rendered="#{payrollBean.contractList.size() > 0}">

                            <div class="table-responsive">
				                <h:dataTable value="#{payrollBean.contractList}" var="item" class="table table-striped" >
						
									<h:column>
										<ui:fragment rendered="#{item.canceled}">
											<i class="fa fa-times text-danger"></i>
										</ui:fragment>
										<ui:fragment rendered="#{not item.canceled}">
											<h:panelGroup rendered="#{item.enabled}"><i class="fa fa-check-square-o"></i></h:panelGroup>
											<h:panelGroup rendered="#{not item.enabled}"><i class="fa fa-square-o"></i></h:panelGroup>
										</ui:fragment>
									</h:column>
									<h:column>
										<f:facet name="header">Order ID</f:facet>
										<h:outputText value="#{item.id}" />
									</h:column>
									<h:column>
										<f:facet name="header">Art</f:facet>
										<h:panelGroup rendered="#{item.extensionOfTerm}">
											VVL
										</h:panelGroup>
										<h:panelGroup rendered="#{not item.extensionOfTerm}">
											BNT
										</h:panelGroup>
									</h:column>
									<h:column>
										<f:facet name="header">Tarif</f:facet>
										<h:outputText value="#{item.cachedTariff.productName}" />
									</h:column>
									<h:column>
										<f:facet name="header">Optionen</f:facet>
										<ui:repeat var="option" value="#{item.cachedTariffOptionList}">
											<p><h:outputText value="#{option.productName}" /></p> 
										</ui:repeat>
									</h:column>
									<h:column>
										<f:facet name="header">Filiale</f:facet>
										<h:outputText value="#{item.shop.name}" />
									</h:column>
									<h:column >
										<f:facet name="header">VO</f:facet>
										<h:outputText value="#{item.vo.name}" />
									</h:column>
									<h:column>
										<f:facet name="header">Laufzeit</f:facet>
										<h:outputText value="#{item.effectiveDate}" >
									  		<f:convertDateTime type="date" pattern="dd.MM.yy" timeZone="CET"/>
									  	</h:outputText> - 
										<h:outputText value="#{item.expiryDate}" >
									  		<f:convertDateTime type="date" pattern="dd.MM.yy" timeZone="CET"/>
									  	</h:outputText>
									</h:column>
									<h:column>
										<f:facet name="header">Punkte</f:facet>
										<span class="text-navy">
											<h:outputText value="#{item.finalCommission.points}" >
												<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
											</h:outputText>
											<i class="fa fa-star"></i>
										</span>
									</h:column>
									<h:column >
										<h:commandLink action="/customer/contractView" class="btn btn-sm btn-primary ">
												<f:setPropertyActionListener value="#{item.customer}" target="#{customerBean.selectedCustomer}" />
												<f:setPropertyActionListener value="#{item}" target="#{contractBean.selectedContract}" />
												<i class="fa fa-search"></i>
										</h:commandLink>
									</h:column>
									
									
									
									
								</h:dataTable>
                            
                            </div>
                        
                        	</h:panelGroup>
                        	
                        </div>

                    </div>
                </div>
            </h:form>
        </div>
		

<div class="row">
			<h:form id="salesOrderForm">
                <div class="col-lg-12">
                    <div class="ibox">
                        <div class="ibox-title">
                            <h5>Verkäufe</h5>
                            <div class="ibox-tools">
                            </div>
                        </div>
                        <div class="ibox-content">
                        
				    		<h:panelGroup rendered="#{payrollBean.orderList.size() == 0}">
				                	<p>Keine Verkäufe zur Ansicht vorhanden.</p>
				            </h:panelGroup>
				    		
				    		<h:panelGroup rendered="#{payrollBean.orderList.size() > 0}">

                            <div class="table-responsive">
				                <h:dataTable value="#{payrollBean.orderList}" var="item" class="table table-striped" >
						
									<h:column>
										<h:panelGroup rendered="#{item.enabled}"><i class="fa fa-check-square-o"></i></h:panelGroup>
										<h:panelGroup rendered="#{not item.enabled}"><i class="fa fa-square-o"></i></h:panelGroup>
									</h:column>
									<h:column>
										<f:facet name="header">Kunde</f:facet>
										<h:outputText value="#{item.customer.name}" />
									</h:column>
									<h:column>
										<f:facet name="header">Produkte</f:facet>
										<ui:repeat var="orderItem" value="#{item.orderItemList}">
											<p><h:outputText value="#{orderItem.title}" /></p> 
										</ui:repeat>
									</h:column>
									<h:column>
										<f:facet name="header">Filiale</f:facet>
										<h:outputText value="#{item.shop.name}" />
									</h:column>
									<h:column>
										<f:facet name="header">Buchungsdatum</f:facet>
										<h:outputText value="#{item.effectiveDate}" >
									  		<f:convertDateTime type="date" pattern="dd.MM.yy" timeZone="CET"/>
									  	</h:outputText>
									</h:column>
									<h:column>
										<f:facet name="header">Punkte</f:facet>
										<span class="text-navy">
											<h:outputText value="#{item.commission.points}" >
												<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
											</h:outputText>
											<i class="fa fa-star"></i>
										</span>
									</h:column>
									<h:column >
										<h:commandLink action="/customer/order" class="btn btn-sm btn-success " rendered="#{empty item.subsidyContract}">
											<f:setPropertyActionListener value="#{item.customer}" target="#{customerBean.selectedCustomer}" />
											<f:setPropertyActionListener value="#{item}" target="#{orderBean.selectedOrder}" />
											<i class="fa fa-search"></i>
									    </h:commandLink>
	                                    
										<h:commandLink action="/customer/contractView" class="btn btn-sm btn-success "  rendered="#{not empty item.subsidyContract}">
											<f:setPropertyActionListener value="#{item.customer}" target="#{customerBean.selectedCustomer}" />
											<f:setPropertyActionListener value="#{item.subsidyContract}" target="#{contractBean.selectedContract}" />
											<i class="fa fa-search"></i>
									    </h:commandLink>
										    
									</h:column>
									
									
									
									
								</h:dataTable>
                            
                            </div>
                        
                        	</h:panelGroup>
                        	
                        </div>

                    </div>
                </div>
            </h:form>
        </div>
			
			</h:form>
		</ui:define>
		
	</ui:composition>
</h:body>
</html>